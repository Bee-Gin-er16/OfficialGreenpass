rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    function signedIn() { return request.auth != null; }
    function isAdmin() { return signedIn() && request.auth.token.admin == true; }

      // AboutPageContent
      match /AboutPageContent/{docId} {
        allow read, write: if isAdmin();
      }

      // Agent
      match /Agent/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // AgentPackage
      match /AgentPackage/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // Asset
      match /Asset/{docId} {
        allow read: if true;
        allow write: if false;
      }

      // BankSettings
      match /BankSettings/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // BrandSettings
      match /BrandSettings/{docId} {
        allow read, write: if isAdmin();
      }

      // Case
      match /Case/{docId} {
        allow create: if signedIn() && request.resource.data.student_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.student_id == request.auth.uid;
      }

      // ChatSettings
      match /ChatSettings/{docId} {
        allow read, write: if isAdmin();
      }

      // Contact
      match /Contact/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // ContactPageContent
      match /ContactPageContent/{docId} {
        allow read, write: if isAdmin();
      }

      // Conversation
      match /Conversation/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // Event
      match /Event/{docId} {
        allow read: if true;
        allow write: if false;
      }

      // EventAssignment
      match /EventAssignment/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // EventRegistration
      match /EventRegistration/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // ExhibitorRegistration
      match /ExhibitorRegistration/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // FAQ
      match /FAQ/{docId} {
        allow read: if true;
        allow write: if false;
      }

      // FairEvent
      match /FairEvent/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // HomePageContent
      match /HomePageContent/{docId} {
        allow read, write: if isAdmin();
      }

      // Institution
      match /Institution/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // KnowledgeBase
      match /KnowledgeBase/{docId} {
        allow read: if true;
        allow write: if false;
      }

      // Lead
      match /Lead/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // MarketplaceOrder
      match /MarketplaceOrder/{docId} {
        allow create: if signedIn() && request.resource.data.student_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.student_id == request.auth.uid;
      }

      // Message
      match /Message/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // OurTeamPageContent
      match /OurTeamPageContent/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // Package
      match /Package/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // Payment
      match /Payment/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // Post
      match /Post/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // Program
      match /Program/{docId} {
        allow read: if true;
        allow write: if false;
      }

      // Registration
      match /Registration/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // Reservation
      match /Reservation/{docId} {
        allow create: if signedIn() && request.resource.data.student_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.student_id == request.auth.uid;
      }

      // School
      match /School/{docId} {
        allow read: if true;
        allow write: if false;
      }

      // SchoolProfile
      match /SchoolProfile/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // Service
      match /Service/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // StudentRSVP
      match /StudentRSVP/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // StudentTutorPackage
      match /StudentTutorPackage/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // SupportAgent
      match /SupportAgent/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // SupportTicket
      match /SupportTicket/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // Tutor
      match /Tutor/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // TutorPackage
      match /TutorPackage/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // TutoringSession
      match /TutoringSession/{docId} {
        allow create: if signedIn() && request.resource.data.student_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.student_id == request.auth.uid;
      }

      // User
      match /User/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // Vendor
      match /Vendor/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // VisaDocument
      match /VisaDocument/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // VisaPackage
      match /VisaPackage/{docId} {
        allow create: if signedIn();
        allow read: if signedIn();
        allow update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // VisaRequest
      match /VisaRequest/{docId} {
        allow create: if signedIn() && request.resource.data.student_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.student_id == request.auth.uid;
      }

      // Wallet
      match /Wallet/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

      // WalletTransaction
      match /WalletTransaction/{docId} {
        allow create: if signedIn() && request.resource.data.user_id == request.auth.uid;
        allow read, update, delete: if signedIn() && resource.data.user_id == request.auth.uid;
      }

    match /{document=**} {
      allow read, write: if false;
    }
  }
}